<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TentacleOS v4.1.8 // HIVE_MIND_INTERFACE</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono&family=VT323&display=swap');

        :root {
            --bg-deep: #0a0014;
            --bg-medium: #1a0f2a;
            --border-color: #3a2f4a;
            --window-bg: rgba(26, 15, 42, 0.85);
            --text-primary: #d0c8e0;
            --text-secondary: #8c82a0;
            --accent-cyan: #00e5ff;
            --accent-magenta: #ff00e5;
            --accent-green: #39ff14;
            --accent-red: #ff3914;
            --font-main: 'Share Tech Mono', monospace;
            --font-display: 'VT323', monospace;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: var(--font-main);
            background: var(--bg-deep);
            color: var(--text-primary);
            overflow: hidden;
            height: 100vh;
            cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="%2300e5ff" stroke-width="1.5"><path d="M12 2L12 22 M2 12L22 12 M5 5L19 19 M5 19L19 5"/></svg>'), auto;
        }

        /* --- Overlays & Background --- */
        .crt-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: 9999;
            animation: flicker 0.15s infinite;
        }
        @keyframes flicker {
            0% { opacity: 1; } 50% { opacity: 0.95; } 100% { opacity: 1; }
        }

        .desktop-bg {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1;
            background-color: var(--bg-deep);
            transition: background-image 0.5s ease-in-out;
        }

        .desktop-bg.phase-0 {
            background-image:
                radial-gradient(circle at 15% 15%, rgba(0, 229, 255, 0.1), transparent 30%),
                radial-gradient(circle at 85% 75%, rgba(255, 0, 229, 0.1), transparent 30%);
            animation: pulse-bg 15s ease-in-out infinite alternate;
        }
        @keyframes pulse-bg {
            from { background-color: var(--bg-deep); }
            to { background-color: #05000a; }
        }

        /* --- Boot Screen --- */
        .boot-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--bg-deep); z-index: 10000;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            color: var(--accent-green); font-family: var(--font-display);
            transition: opacity 1s ease;
        }
        .boot-logo { width: 80px; height: 80px; margin-bottom: 20px; color: var(--accent-cyan); animation: boot-flicker 3s infinite; }
        @keyframes boot-flicker {
            0%, 100% { opacity: 1; filter: drop-shadow(0 0 5px var(--accent-cyan)); }
            50% { opacity: 0.8; filter: drop-shadow(0 0 15px var(--accent-cyan)); }
        }
        .boot-text { font-family: var(--font-main); text-align: left; line-height: 1.8; font-size: 14px; max-width: 600px; height: 250px; overflow: hidden; }
        .progress-bar { width: 500px; height: 4px; background: var(--border-color); margin-top: 20px; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, var(--accent-cyan), var(--accent-magenta)); width: 0%; transition: width 0.2s ease; }

        /* --- Taskbar --- */
        .taskbar {
            position: fixed; bottom: 0; left: 0; width: 100%; height: 44px; z-index: 1000;
            background: var(--window-bg); backdrop-filter: blur(10px);
            border-top: 1px solid var(--border-color);
            display: flex; align-items: center; justify-content: space-between;
            padding: 0 20px; font-family: var(--font-main);
        }
        .start-button {
            display: flex; align-items: center; gap: 10px; padding: 0 15px; height: 100%;
            cursor: pointer; font-weight: bold; font-size: 14px; color: var(--text-primary);
            transition: all 0.2s ease;
        }
        .start-button:hover, .start-button.active { background: var(--border-color); color: var(--accent-cyan); }
        .start-icon { width: 22px; height: 22px; }
        .system-info { display: flex; gap: 20px; font-size: 12px; color: var(--text-secondary); }
        .system-info span { animation: glitch-text 10s infinite steps(1); }
        @keyframes glitch-text {
            0%, 99.5% { opacity: 1; } 99.6% { opacity: 0; transform: translateX(2px); } 99.8% { opacity: 1; transform: translateX(-2px); }
        }
        .system-time { font-family: var(--font-display); font-size: 18px; color: var(--accent-green); }

        /* --- Start Menu --- */
        .start-menu {
            position: fixed; bottom: 45px; left: 0; width: 320px;
            background: var(--window-bg); backdrop-filter: blur(15px);
            border: 1px solid var(--border-color); border-radius: 4px;
            box-shadow: 0 0 40px rgba(0, 0, 0, 0.7); z-index: 1001;
            transform: scale(0.95) translateY(10px); transform-origin: bottom left; opacity: 0;
            transition: all 0.2s cubic-bezier(0.18, 0.89, 0.32, 1.28); pointer-events: none;
        }
        .start-menu.active { transform: scale(1) translateY(0); opacity: 1; pointer-events: all; }
        .start-menu-header {
            padding: 12px 15px; font-weight: bold;
            border-bottom: 1px solid var(--border-color); font-family: var(--font-display); font-size: 18px; color: var(--accent-cyan);
        }
        .start-menu-content { padding: 10px 0; }
        .menu-item {
            display: flex; align-items: center; gap: 12px; padding: 10px 20px;
            cursor: pointer; transition: all 0.2s ease; font-size: 14px;
        }
        .menu-item:hover { background: var(--border-color); color: var(--accent-cyan); }
        .menu-item-icon { width: 20px; height: 20px; color: var(--accent-cyan); }
        
        /* --- Desktop Icons --- */
        .desktop-icons { position: absolute; top: 20px; left: 20px; display: grid; grid-template-columns: repeat(auto-fill, 90px); gap: 20px; }
        .desktop-icon { display: flex; flex-direction: column; align-items: center; gap: 8px; padding: 10px; cursor: pointer; transition: background-color 0.2s; border-radius: 4px; text-align: center; }
        .desktop-icon:hover { background: rgba(0, 229, 255, 0.1); }
        .desktop-icon-image { width: 48px; height: 48px; color: var(--accent-cyan); }
        .desktop-icon-label { font-size: 12px; color: var(--text-primary); text-shadow: 1px 1px 3px var(--bg-deep); }
        
        /* --- Windows --- */
        .window {
            position: absolute; min-width: 450px; min-height: 350px;
            background: var(--window-bg); backdrop-filter: blur(12px);
            border: 1px solid var(--border-color); border-radius: 4px;
            box-shadow: 0 10px 50px rgba(0, 0, 0, 0.8);
            display: none; z-index: 100; resize: both; overflow: hidden;
            font-family: var(--font-main); display: flex; flex-direction: column;
            animation: open-window 0.3s cubic-bezier(0.18, 0.89, 0.32, 1.28);
        }
        @keyframes open-window {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }
        .window-titlebar {
            background: var(--bg-medium); color: var(--text-primary); padding: 8px 12px;
            display: flex; justify-content: space-between; align-items: center;
            cursor: move; user-select: none; font-size: 14px; font-weight: bold;
            border-bottom: 1px solid var(--border-color); flex-shrink: 0;
        }
        .window-titlebar-icon { width: 16px; height: 16px; margin-right: 8px; color: var(--accent-cyan); }
        .window-controls { display: flex; gap: 5px; }
        .window-control {
            width: 22px; height: 22px; display: flex; align-items: center; justify-content: center;
            background: var(--border-color); color: var(--text-primary);
            cursor: pointer; font-size: 14px; transition: all 0.2s ease;
        }
        .window-control:hover { background: var(--accent-red); color: var(--bg-deep); }
        .window-content { padding: 15px; overflow: auto; flex-grow: 1; line-height: 1.7; }

        /* --- Terminal & Console Styles --- */
        #terminalWindow .window-content, #secureConsoleWindow .window-content {
            background: rgba(0,0,0,0.8); padding: 10px;
        }
        .terminal-output { flex: 1; overflow-y: auto; margin-bottom: 10px; color: var(--accent-green); font-size: 14px; font-family: var(--font-display); }
        .terminal-input-line { display: flex; align-items: center; }
        .terminal-prompt { color: var(--accent-cyan); margin-right: 8px; }
        .terminal-command {
            flex: 1; background: transparent; border: none; color: var(--accent-green);
            font-family: var(--font-display); font-size: 14px; outline: none; caret-color: var(--accent-green);
        }
        .terminal-output .error { color: var(--accent-red); }
        .terminal-output .info { color: var(--text-secondary); }
        .terminal-output .success { color: var(--accent-green); }
        .terminal-output .input { color: var(--accent-cyan); }

        #secureConsoleWindow .terminal-command { font-size: 16px; border-bottom: 2px solid var(--accent-green); }

        /* --- Appearance App Styles --- */
        .appearance-content button {
            background: var(--bg-medium); border: 1px solid var(--border-color); color: var(--text-primary);
            padding: 8px 12px; cursor: pointer; font-family: var(--font-main); transition: all 0.2s ease;
        }
        .appearance-content button:hover { background-color: var(--border-color); color: var(--accent-cyan); }
    </style>
</head>
<body>
    <div class="boot-screen" id="bootScreen">
        <div class="boot-logo" id="bootLogoSVG"></div>
        <div class="boot-text" id="bootText"></div>
        <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
    </div>

    <div class="desktop-bg phase-0" id="desktopBg"></div>
    <div class="crt-overlay"></div>
    <div class="desktop-icons" id="desktopIcons"></div>

    <div class="taskbar">
        <div class="start-button"><div class="start-icon"></div><span>CORE</span></div>
        <div class="system-info">
            <span id="cpuLoad">CPU: 13%</span>
            <span id="memUsage">MEM: 1.8GB</span>
            <span id="psyStatus">PSY-LEVEL: STABLE</span>
            <span id="anchorStatus">REALITY_ANCHOR: SYNCED</span>
        </div>
        <div class="system-time" id="systemTime"></div>
    </div>

    <div class="start-menu" id="startMenu">
        <div class="start-menu-header">TentacleOS v4.1.8</div>
        <div class="start-menu-content" id="startMenuContent"></div>
    </div>

    <div id="windowContainer"></div>

<script>
document.addEventListener('DOMContentLoaded', () => {

    const ICONS = {
        logo: `<svg viewBox="0 0 100 100" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"><path d="M50 30 C 50 50, 30 50, 30 70 S 50 90, 50 90 M50 30 C 50 50, 70 50, 70 70 S 50 90, 50 90 M50 30 C 60 20, 40 20, 50 30 M35 40 C 25 30, 25 50, 35 40 M65 40 C 75 30, 75 50, 65 40"/><circle cx="50" cy="50" r="40"/></svg>`,
        terminal: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 17l6-6-6-6M12 19h8"/></svg>`,
        archives: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path><circle cx="12" cy="13" r="2"></circle></svg>`,
        files: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path></svg>`,
        appearance: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0L12 2.69z"></path></svg>`,
        shutdown: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18.36 6.64a9 9 0 1 1-12.73 0"></path><line x1="12" y1="2" x2="12" y2="12"></line></svg>`
    };

    const APPS = [
        { id: 'terminal', name: 'Terminal', icon: ICONS.terminal, content: `<div class="terminal-output" id="terminalOutput">TentacleOS [Version 4.1.8]\n(c) Omnipresent Conglomerate.\n\n</div><div class="terminal-input-line"><span class="terminal-prompt">operator@tentacle-os:~$</span><input type="text" class="terminal-command" id="terminalInput"></div>`, init: termInit },
        { id: 'secureConsole', name: 'Secure Archives', icon: ICONS.archives, content: `<div class="terminal-output" id="secureConsoleOutput">OMNI.NET SECURE ARCHIVAL NODE\nAUTHORIZATION REQUIRED\n\nENTER KEYPHRASE:</div><div class="terminal-input-line"><input type="password" class="terminal-command" id="secure-console-input"></div>`, init: secureConsoleInit },
        { id: 'files', name: 'File Explorer', icon: ICONS.files, content: `<h3>File System Corrupted</h3><p>Unable to read directory structure. Unidentified organic matter detected on drive C:. Running diagnostics is not recommended.</p><p style="color: var(--accent-red);">QUARANTINE PROTOCOL ACTIVE.</p>` },
        { id: 'appearance', name: 'Appearance', icon: ICONS.appearance, content: `<div class="appearance-content" style="display:flex; flex-direction:column; gap:20px;"><div><label for="bgUploadInput">Set Custom Reality Matrix (Background):</label><input type="file" id="bgUploadInput" accept="image/*"></div><div><button id="resetBgBtn">Reset to Default Matrix</button></div></div>`, init: appearanceInit },
        { id: 'shutdown', name: 'Shutdown', icon: ICONS.shutdown, type: 'action', action: shutdownSystem }
    ];

    const passwordVault = {
        'ARKLAY_88': 'indexes/index1.html',
        'PROGENITOR': 'indexes/index2.html',
        'UROBOROS': 'indexes/index3.html',
        'CADOU_PARASITE': 'indexes/index4.html',
        'ISHIMURA_USG': 'indexes/index5.html',
        'AEGIS_7': 'indexes/index6.html',
        'LUNAR_PYRAMID': 'indexes/index7.html',
        'KENDALL_44': 'indexes/index8.html',
        'BYRGENWERTH': 'indexes/index9.html',
        'MOON_PRESENCE': 'indexes/index10.html'
    };

    // --- DOM & STATE ---
    let startMenuOpen = false, windowZIndex = 100;
    const activeWindows = {};
    const getEl = id => document.getElementById(id);
    const bootScreen = getEl('bootScreen'), bootText = getEl('bootText'), progressFill = getEl('progressFill'),
          desktopBg = getEl('desktopBg'), desktopIconsContainer = getEl('desktopIcons'),
          startMenuContent = getEl('startMenuContent'), windowContainer = getEl('windowContainer'),
          startButton = document.querySelector('.start-button'), startMenu = getEl('startMenu');

    // --- INITIALIZATION ---
    function initBoot() {
        getEl('bootLogoSVG').innerHTML = ICONS.logo;
        document.querySelector('.start-button .start-icon').innerHTML = ICONS.logo;

        const bootLines = [
            "Calibrating psychic dampeners...",
            "[0.1337] Hive-mind link detected. Status: DORMANT",
            "[0.2451] Reality anchor initializing...",
            "[0.5890] Non-Euclidean geometry drivers... loaded.",
            "[0.7101] WARNING: Memetic hazard detected in boot sector.",
            "[0.8432] Purging cognitive intrusion... OK",
            "[1.2131] Synchronizing with local timeline.",
            "[1.5000] Welcome, Operator. The flesh is a machine."
        ];
        let lineIndex = 0;
        const bootInterval = setInterval(() => {
            if (lineIndex < bootLines.length) {
                const line = bootLines[lineIndex++];
                const color = line.includes('WARNING') ? 'var(--accent-red)' : 'var(--accent-green)';
                bootText.innerHTML += `<span style="color:${color}">${line}</span><br>`;
                bootText.scrollTop = bootText.scrollHeight;
                progressFill.style.width = (lineIndex / bootLines.length) * 100 + '%';
            } else {
                clearInterval(bootInterval);
                setTimeout(() => {
                    bootScreen.style.opacity = '0';
                    setTimeout(() => { bootScreen.style.display = 'none'; initDesktop(); }, 1000);
                }, 500);
            }
        }, 300);
    }

    function initDesktop() {
        APPS.forEach(app => {
            const iconEl = document.createElement('div');
            iconEl.className = 'desktop-icon';
            iconEl.dataset.app = app.id;
            iconEl.innerHTML = `<div class="desktop-icon-image">${app.icon}</div><div class="desktop-icon-label">${app.name}</div>`;
            iconEl.addEventListener('dblclick', () => launchApp(app.id));
            desktopIconsContainer.appendChild(iconEl);

            const itemEl = document.createElement('div');
            itemEl.className = 'menu-item';
            itemEl.innerHTML = `<div class="menu-item-icon">${app.icon}</div><span>${app.name}</span>`;
            itemEl.onclick = () => launchApp(app.id);
            startMenuContent.appendChild(itemEl);
        });
        setInterval(updateSystemInfo, 3000);
        setInterval(() => getEl('systemTime').textContent = new Date().toLocaleTimeString('en-GB'), 1000);
    }
    
    // --- UI UPDATES & SYSTEM FUNCTIONS ---
    function updateSystemInfo() {
        getEl('cpuLoad').textContent = `CPU: ${Math.floor(5 + Math.random() * 20)}%`;
        getEl('memUsage').textContent = `MEM: ${(1.2 + Math.random() * 1.5).toFixed(1)}GB`;
        const psyStates = ['STABLE', 'FLUCTUATING', 'ECHOES DETECTED', 'CALM'];
        getEl('psyStatus').textContent = `PSY-LEVEL: ${psyStates[Math.floor(Math.random() * psyStates.length)]}`;
    }

    function shutdownSystem() {
        bootScreen.innerHTML = `<div class="boot-logo" style="color:var(--accent-red);">${ICONS.shutdown}</div><div style="font-size:24px; color:var(--accent-red);">CONNECTION SEVERED</div>`;
        bootScreen.style.opacity = '1';
        bootScreen.style.display = 'flex';
    }

    // --- APP & WINDOW MANAGEMENT ---
    function launchApp(appId) {
        if (startMenuOpen) toggleStartMenu(false);
        const app = APPS.find(a => a.id === appId);
        if (!app) return;
        if (app.type === 'action') {
            if (app.action) app.action();
        } else {
            createWindow(app);
        }
    }

    function createWindow(app) {
        if (activeWindows[app.id]) { focusWindow(app.id); return; }
        const win = document.createElement('div');
        win.id = `${app.id}Window`;
        win.className = 'window';
        win.style.left = `${100 + Math.random() * 200}px`;
        win.style.top = `${50 + Math.random() * 150}px`;
        win.style.zIndex = ++windowZIndex;
        win.innerHTML = `
            <div class="window-titlebar">
                <div><span class="window-titlebar-icon">${app.icon}</span><span>${app.name}</span></div>
                <div class="window-controls"><div class="window-control" data-action="close">×</div></div>
            </div>
            <div class="window-content">${app.content || ''}</div>`;
        windowContainer.appendChild(win);
        activeWindows[app.id] = win;
        win.querySelector('.window-titlebar').addEventListener('mousedown', e => onDragStart(e, win));
        win.addEventListener('mousedown', () => focusWindow(app.id));
        win.querySelector('.window-control[data-action="close"]').onclick = () => closeWindow(app.id);
        if (app.init) app.init(win);
    }

    function closeWindow(appId) {
        const win = activeWindows[appId];
        if (win) {
            win.style.animation = 'open-window 0.3s reverse';
            setTimeout(() => {
                win.remove();
                delete activeWindows[appId];
            }, 300);
        }
    }

    function focusWindow(appId) {
        if (activeWindows[appId]) activeWindows[appId].style.zIndex = ++windowZIndex;
    }
    
    function onDragStart(e, win) {
        if (e.target.closest('.window-control')) return;
        focusWindow(win.id.replace('Window', ''));
        const offsetX = e.clientX - win.offsetLeft, offsetY = e.clientY - win.offsetTop;
        const onDrag = (moveEvent) => {
            win.style.left = `${moveEvent.clientX - offsetX}px`;
            win.style.top = `${moveEvent.clientY - offsetY}px`;
        };
        document.addEventListener('mousemove', onDrag);
        document.addEventListener('mouseup', () => document.removeEventListener('mousemove', onDrag), { once: true });
    }

    // --- APP INIT FUNCTIONS ---
    function termInit(win) {
        const input = win.querySelector('#terminalInput'), output = win.querySelector('#terminalOutput');
        input.focus();
        input.addEventListener('keydown', e => {
            if (e.key === 'Enter' && input.value) {
                output.innerHTML += `<div class="input">operator@tentacle-os:~$ ${input.value}</div>`;
                let response = `<div class="error">command not found: ${input.value.split(' ')[0]}</div>`;
                if (input.value.trim() === 'help') response = `<div class="info">Commands: help, clear, whoami, exit</div>`;
                if (input.value.trim() === 'clear') output.innerHTML = '';
                if (input.value.trim() === 'whoami') response = `<div class="info">You are a vessel.</div>`;
                if (input.value.trim() === 'exit') closeWindow('terminal');
                output.innerHTML += response;
                input.value = '';
                output.scrollTop = output.scrollHeight;
            }
        });
    }

    function secureConsoleInit(win) {
        const input = win.querySelector('#secure-console-input'), output = win.querySelector('#secureConsoleOutput');
        input.focus();
        input.addEventListener('keydown', e => {
            if (e.key === 'Enter' && input.value) {
                const cmd = input.value.trim().toUpperCase();
                input.value = '';
                if (passwordVault[cmd]) {
                    output.innerHTML += `\n> KEYPHRASE ACCEPTED.\n<span class="success">DECRYPTING... OPENING FILE...</span>\n`;
                    setTimeout(() => window.open(passwordVault[cmd], '_blank'), 1000);
                } else {
                    output.innerHTML += `\n> KEYPHRASE REJECTED.\n<span class="error">ACCESS DENIED.</span>\n`;
                }
                setTimeout(() => output.innerHTML += `\nENTER KEYPHRASE:`, 1000);
            }
        });
    }

    function appearanceInit(win) {
        win.querySelector('#bgUploadInput').addEventListener('change', e => {
            const file = e.target.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = (event) => {
                desktopBg.className = 'desktop-bg';
                desktopBg.style.backgroundImage = `url(${event.target.result})`;
                desktopBg.style.backgroundSize = 'cover';
                desktopBg.style.backgroundPosition = 'center';
            };
            reader.readAsDataURL(file);
        });
        win.querySelector('#resetBgBtn').addEventListener('click', () => {
            desktopBg.style.backgroundImage = '';
            desktopBg.className = 'desktop-bg phase-0';
        });
    }
    
    // --- EVENT LISTENERS ---
    function toggleStartMenu(state) {
        startMenuOpen = state !== undefined ? state : !startMenuOpen;
        startMenu.classList.toggle('active', startMenuOpen);
        startButton.classList.toggle('active', startMenuOpen);
    }
    startButton.addEventListener('click', e => { e.stopPropagation(); toggleStartMenu(); });
    document.addEventListener('click', () => { if (startMenuOpen) toggleStartMenu(false); });

    initBoot();
});
</script>
</body>
</html>
