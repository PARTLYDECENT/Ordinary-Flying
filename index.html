<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aegis OS v3.1.4 // Corporate Intranet</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono&family=VT323&display=swap');

        :root {
            --bg-dark: #0d1117;
            --bg-medium: #161b22;
            --border-color: #30363d;
            --window-bg: rgba(13, 17, 23, 0.85);
            --text-primary: #c9d1d9;
            --text-secondary: #8b949e;
            --accent-blue: #58a6ff;
            --accent-green: #3fb950;
            --accent-red: #f85149;
            --font-main: 'Share Tech Mono', monospace;
            --font-display: 'VT323', monospace;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: var(--font-main);
            background: var(--bg-dark);
            color: var(--text-primary);
            overflow: hidden;
            height: 100vh;
            cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"><path d="M2 2 L14 2 L14 14 L2 14 Z" fill="none" stroke="%2358a6ff" stroke-width="1"/><path d="M8 4 L8 12 M4 8 L12 8" fill="none" stroke="%2358a6ff" stroke-width="1"/></svg>'), auto;
        }

        /* --- Overlays & Background --- */
        .crt-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: 9999;
            background: repeating-linear-gradient(0deg, transparent, transparent 1px, rgba(88, 166, 255, 0.03) 1px, rgba(88, 166, 255, 0.03) 2px);
            animation: scanlines 0.2s linear infinite;
        }
        @keyframes scanlines { from { background-position: 0 0; } to { background-position: 0 4px; } }

        .desktop-bg {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: -1; transition: background-image 0.5s ease-in-out;
            background-color: var(--bg-dark);
        }

        .desktop-bg.phase-0 {
            background-image:
                repeating-linear-gradient(45deg, var(--border-color) 0, var(--border-color) 1px, transparent 1px, transparent 35px),
                repeating-linear-gradient(-45deg, var(--border-color) 0, var(--border-color) 1px, transparent 1px, transparent 35px);
            animation: bg-pan 60s linear infinite;
        }
        @keyframes bg-pan { from { background-position: 0 0; } to { background-position: 700px 700px; } }
        
        .desktop-bg::before {
            content: ""; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background-image: url('data:image/svg+xml;utf8,<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><filter id="n"><feTurbulence type="fractalNoise" baseFrequency="0.8" numOctaves="3" stitchTiles="stitch"/></filter><rect width="100%" height="100%" filter="url(%23n)"/></svg>');
            opacity: 0.05; mix-blend-mode: overlay; pointer-events: none;
        }

        /* --- Boot Screen --- */
        .boot-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--bg-dark); z-index: 10000;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            color: var(--accent-green); font-family: var(--font-display);
            transition: opacity 1s ease;
        }
        .boot-logo { font-size: 64px; margin-bottom: 20px; animation: boot-flicker 3s infinite; }
        @keyframes boot-flicker {
            0%, 100% { opacity: 1; text-shadow: 0 0 10px var(--accent-blue); }
            50% { opacity: 0.8; text-shadow: 0 0 20px var(--accent-blue); }
        }
        .boot-text { font-family: var(--font-main); text-align: left; line-height: 1.8; font-size: 14px; max-width: 600px; height: 250px; overflow: hidden; }
        .progress-bar { width: 500px; height: 20px; border: 2px solid var(--accent-blue); margin-top: 20px; }
        .progress-fill { height: 100%; background: var(--accent-blue); width: 0%; }

        /* --- Taskbar --- */
        .taskbar {
            position: fixed; bottom: 0; left: 0; width: 100%; height: 48px; z-index: 1000;
            background: var(--window-bg); backdrop-filter: blur(10px);
            border-top: 2px solid var(--border-color);
            display: flex; align-items: center; justify-content: space-between;
            padding: 0 20px; font-family: var(--font-main);
        }
        .start-button {
            display: flex; align-items: center; gap: 10px; padding: 8px 15px;
            background: var(--bg-medium); border: 1px solid var(--border-color); color: var(--text-primary);
            cursor: pointer; font-weight: bold; font-size: 14px;
            transition: all 0.2s ease;
        }
        .start-button:hover { background: var(--border-color); color: var(--accent-blue); }
        .start-icon { font-size: 20px; }
        .system-info { display: flex; gap: 20px; font-size: 12px; color: var(--text-secondary); }
        .system-time { font-family: var(--font-display); font-size: 18px; color: var(--accent-green); }

        /* --- Start Menu --- */
        .start-menu {
            position: fixed; bottom: 50px; left: 20px; width: 350px;
            background: var(--window-bg); backdrop-filter: blur(15px);
            border: 2px solid var(--border-color); border-radius: 5px;
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.5); z-index: 1001;
            transform: scaleY(0); transform-origin: bottom; opacity: 0;
            transition: all 0.3s cubic-bezier(0.18, 0.89, 0.32, 1.28);
        }
        .start-menu.active { transform: scaleY(1); opacity: 1; }
        .start-menu-header {
            background: var(--bg-medium); color: var(--text-primary); padding: 12px 15px; font-weight: bold;
            border-bottom: 2px solid var(--border-color); font-family: var(--font-display); font-size: 18px;
        }
        .start-menu-content { padding: 10px 0; }
        .menu-item {
            display: flex; align-items: center; gap: 12px; padding: 12px 20px;
            cursor: pointer; transition: all 0.2s ease; font-size: 14px;
            border-left: 3px solid transparent;
        }
        .menu-item:hover { background: var(--border-color); border-left-color: var(--accent-blue); }
        .menu-item-icon { font-size: 18px; width: 20px; text-align: center; color: var(--accent-blue); }
        
        /* --- Desktop Icons --- */
        .desktop-icons { position: absolute; top: 20px; left: 20px; display: grid; grid-template-columns: repeat(auto-fill, 90px); gap: 20px; }
        .desktop-icon { display: flex; flex-direction: column; align-items: center; gap: 8px; padding: 10px; cursor: pointer; transition: background-color 0.2s; border-radius: 4px; text-align: center; }
        .desktop-icon:hover { background: rgba(88, 166, 255, 0.1); }
        .desktop-icon-image { font-size: 42px; }
        .desktop-icon-label { font-size: 12px; color: var(--text-primary); text-shadow: 1px 1px 3px var(--bg-dark); }
        
        /* --- Windows --- */
        .window {
            position: absolute; min-width: 450px; min-height: 350px;
            background: var(--window-bg); backdrop-filter: blur(12px);
            border: 2px solid var(--border-color); border-radius: 5px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.6);
            display: none; z-index: 100; resize: both; overflow: hidden;
            font-family: var(--font-main); display: flex; flex-direction: column;
        }
        .window-titlebar {
            background: var(--bg-medium); color: var(--text-primary); padding: 8px 12px;
            display: flex; justify-content: space-between; align-items: center;
            cursor: move; user-select: none; font-size: 14px; font-weight: bold;
            border-bottom: 2px solid var(--border-color); flex-shrink: 0;
        }
        .window-controls { display: flex; gap: 5px; }
        .window-control {
            width: 22px; height: 22px; display: flex; align-items: center; justify-content: center;
            background: var(--border-color); color: var(--text-primary);
            cursor: pointer; font-size: 14px; transition: all 0.2s ease;
        }
        .window-control:hover { background: var(--accent-red); }
        .window-content { padding: 15px; overflow: auto; flex-grow: 1; line-height: 1.7; }

        /* --- Terminal Styles --- */
        #terminalWindow .window-content, #secureConsoleWindow .window-content {
            background: rgba(0,0,0,0.8); padding: 10px;
        }
        .terminal-output {
            flex: 1; overflow-y: auto; margin-bottom: 10px; line-height: 1.6;
            color: var(--accent-green); font-size: 14px; font-family: var(--font-display);
        }
        .terminal-input-line { display: flex; align-items: center; }
        .terminal-prompt { color: var(--accent-blue); margin-right: 8px; }
        .terminal-command {
            flex: 1; background: transparent; border: none; color: var(--accent-green);
            font-family: var(--font-display); font-size: 14px; outline: none;
        }
        .terminal-output .error { color: var(--accent-red); }
        .terminal-output .info { color: var(--text-secondary); }
        .terminal-output .success { color: var(--accent-green); }
        .terminal-output .input { color: var(--accent-blue); }

        /* --- Secure Console Specific Styles --- */
        .secure-console-output {
            color: var(--accent-green); font-family: var(--font-display); font-size: 16px; line-height: 2;
        }
        #secure-console-input {
            width: 100%; background: transparent; border: none; color: var(--accent-green);
            font-family: var(--font-display); font-size: 16px; outline: none; border-bottom: 2px solid var(--accent-green);
            caret-color: var(--accent-green);
        }
        
        /* --- Appearance App Styles --- */
        .appearance-content { display: flex; flex-direction: column; gap: 20px; }
        .appearance-content label { font-weight: bold; color: var(--accent-blue); }
        .appearance-content input[type="file"]::file-selector-button, .appearance-content button {
            background: var(--bg-medium); border: 1px solid var(--border-color); color: var(--text-primary);
            padding: 8px 12px; cursor: pointer; font-family: var(--font-main);
            transition: background-color 0.2s ease;
        }
        .appearance-content input[type="file"]::file-selector-button:hover, .appearance-content button:hover {
            background-color: var(--border-color);
        }
    </style>
</head>
<body>
    <div class="boot-screen" id="bootScreen">
        <div class="boot-logo">üõ°Ô∏è</div>
        <div class="boot-text" id="bootText"></div>
        <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
    </div>

    <div class="desktop-bg phase-0" id="desktopBg"></div>
    <div class="crt-overlay"></div>
    <div class="desktop-icons" id="desktopIcons"></div>

    <div class="taskbar">
        <div class="start-button"><span class="start-icon">üõ°Ô∏è</span><span>AEGIS CORE</span></div>
        <div class="system-info">
            <span id="cpuLoad">CPU: 13%</span>
            <span id="memUsage">MEM: 1.8GB</span>
            <span id="netStatus">NET: SECURE</span>
        </div>
        <div class="system-time" id="systemTime"></div>
    </div>

    <div class="start-menu" id="startMenu">
        <div class="start-menu-header">Aegis System Menu</div>
        <div class="start-menu-content" id="startMenuContent"></div>
    </div>

    <div id="windowContainer"></div>

<script>
document.addEventListener('DOMContentLoaded', () => {

    // --- APPLICATION & SYSTEM DATA ---
    const APPS = [
        {
            id: 'terminal', name: 'Terminal', icon: '>',
            content: `<div class="terminal-output" id="terminalOutput">Aegis OS [Version 3.1.4]\n(c) Aegis Corporation. All rights reserved.\n\n</div><div class="terminal-input-line"><span class="terminal-prompt">C:\\Users\\Operator></span><input type="text" class="terminal-command" id="terminalInput"></div>`,
            init: (win) => {
                const input = win.querySelector('#terminalInput');
                input.focus();
                input.addEventListener('keydown', e => {
                    if (e.key === 'Enter' && input.value) {
                        processTerminalCommand(input.value.trim());
                        input.value = '';
                    }
                });
            }
        },
        {
            id: 'secureConsole', name: 'Secure Archives', icon: 'üóÑÔ∏è',
            content: `<div class="secure-console-output" id="secureConsoleOutput">Aegis Secure Vault S-07\nAUTHORIZATION REQUIRED\n\nENTER PASSWORD: </div><div class="terminal-input-line"><input type="password" class="terminal-command" id="secure-console-input"></div>`,
            init: (win) => {
                const input = win.querySelector('#secure-console-input');
                const output = win.querySelector('#secureConsoleOutput');
                input.focus();
                input.addEventListener('keydown', e => {
                    if (e.key === 'Enter' && input.value) {
                        handleSecureCommand(input.value.trim(), output);
                        input.value = '';
                    }
                });
            }
        },
        {
            id: 'fileExplorer', name: 'File Explorer', icon: 'üìÅ',
            content: `<h3>System Files (C:)</h3><p>Access is restricted. Please contact your system administrator.</p>
                     <ul>
                        <li>Program Files (x86)</li>
                        <li>System32</li>
                        <li>Users</li>
                        <li style="color: var(--accent-red);">QUARANTINE</li>
                     </ul>`
        },
        {
            id: 'appearance', name: 'Appearance', icon: 'üé®',
            content: `<div class="appearance-content">
                        <div>
                            <label for="bgUploadInput">Custom Desktop Background:</label>
                            <input type="file" id="bgUploadInput" accept="image/*">
                        </div>
                        <div>
                             <button id="resetBgBtn">Reset to Default</button>
                        </div>
                     </div>`,
            init: (win) => {
                win.querySelector('#bgUploadInput').addEventListener('change', (e) => {
                    const file = e.target.files[0];
                    if (!file) return;
                    const reader = new FileReader();
                    reader.onload = (event) => {
                        desktopBg.className = 'desktop-bg'; // remove animation class
                        desktopBg.style.backgroundImage = `url(${event.target.result})`;
                        desktopBg.style.backgroundSize = 'cover';
                        desktopBg.style.backgroundPosition = 'center';
                    };
                    reader.readAsDataURL(file);
                });
                win.querySelector('#resetBgBtn').addEventListener('click', () => {
                    desktopBg.style.backgroundImage = '';
                    desktopBg.className = 'desktop-bg phase-0';
                });
            }
        },
        {
            id: 'shutdown', name: 'Shutdown', icon: '‚èª', type: 'action',
            action: () => {
                bootScreen.innerHTML = `<div class="boot-logo" style="color:var(--accent-red);">‚èª</div><div style="font-size:24px; color:var(--accent-red);">SYSTEM IS SHUTTING DOWN</div>`;
                bootScreen.style.opacity = '1';
                bootScreen.style.display = 'flex';
            }
        }
    ];

    const passwordVault = {
        'STARS': 'indexes/index1.html',
        'T-VIRUS': 'indexes/index2.html',
        'RACCOONCITY': 'indexes/index3.html',
        'NEMESIS': 'indexes/index4.html',
        'G-VIRUS': 'indexes/index5.html',
        'ELEMENT115': 'indexes/index6.html',
        'SAMANTHA': 'indexes/index7.html',
        'RICHTOFEN': 'indexes/index8.html',
        'KINODERTOTEN': 'indexes/index9.html',
        'DIVISION9': 'indexes/index10.html'
    };

    // --- GLOBAL STATE & DOM ELEMENTS ---
    let startMenuOpen = false, windowZIndex = 100;
    const activeWindows = {};
    const getEl = id => document.getElementById(id);
    const bootScreen = getEl('bootScreen'), bootText = getEl('bootText'), progressFill = getEl('progressFill'),
          desktopBg = getEl('desktopBg'), desktopIconsContainer = getEl('desktopIcons'),
          startMenuContent = getEl('startMenuContent'), windowContainer = getEl('windowContainer'),
          startButton = document.querySelector('.start-button'), startMenu = getEl('startMenu'),
          systemTime = getEl('systemTime'), cpuLoad = getEl('cpuLoad'), memUsage = getEl('memUsage'), netStatus = getEl('netStatus');

    // --- INITIALIZATION ---
    function initBoot() {
        const bootLines = [
            "Initializing Aegis Kernel...",
            "[0.1337] Loading system drivers...",
            "[0.2451] Checking file system on C:",
            "[0.5890] Mounting virtual drives... OK",
            "[0.7101] Network stack initialized. Status: SECURE",
            "[0.8432] WARNING: Unidentified biosignature detected in Sector-B.",
            "[0.9854] Activating containment protocols.",
            "[1.2131] Starting Aegis Desktop Environment...",
            "[1.5000] Welcome, Operator."
        ];
        let lineIndex = 0, progress = 0;
        const bootInterval = setInterval(() => {
            if (lineIndex < bootLines.length) {
                const line = bootLines[lineIndex++];
                const color = line.includes('WARNING') ? 'var(--accent-red)' : 'var(--accent-green)';
                bootText.innerHTML += `<span style="color:${color}">${line}</span><br>`;
                bootText.scrollTop = bootText.scrollHeight;
            }
            progress += 100 / bootLines.length;
            progressFill.style.width = Math.min(100, progress) + '%';
            if (progress >= 100) {
                clearInterval(bootInterval);
                setTimeout(() => {
                    bootScreen.style.opacity = '0';
                    setTimeout(() => { bootScreen.style.display = 'none'; initDesktop(); }, 1000);
                }, 1000);
            }
        }, 250);
    }

    function initDesktop() {
        APPS.forEach(app => {
            // Create Desktop Icon
            const iconEl = document.createElement('div');
            iconEl.className = 'desktop-icon';
            iconEl.dataset.app = app.id;
            iconEl.innerHTML = `<div class="desktop-icon-image">${app.icon}</div><div class="desktop-icon-label">${app.name}</div>`;
            iconEl.addEventListener('dblclick', () => launchApp(app.id));
            desktopIconsContainer.appendChild(iconEl);

            // Create Start Menu Item
            const itemEl = document.createElement('div');
            itemEl.className = 'menu-item';
            itemEl.innerHTML = `<span class="menu-item-icon">${app.icon}</span><span>${app.name}</span>`;
            itemEl.onclick = () => launchApp(app.id);
            startMenuContent.appendChild(itemEl);
        });

        updateTime();
        setInterval(updateTime, 1000);
        setInterval(updateSystemInfo, 3000);
    }
    
    // --- SYSTEM & UI UPDATES ---
    function updateTime() {
        systemTime.textContent = new Date().toLocaleTimeString('en-US', { hour12: false });
    }

    function updateSystemInfo() {
        cpuLoad.textContent = `CPU: ${Math.floor(5 + Math.random() * 20)}%`;
        memUsage.textContent = `MEM: ${(1.2 + Math.random() * 1.5).toFixed(1)}GB`;
        const statuses = ['SECURE', 'STABLE', 'MONITORING...', 'ENCRYPTED'];
        netStatus.textContent = `NET: ${statuses[Math.floor(Math.random() * statuses.length)]}`;
    }

    // --- APP & WINDOW MANAGEMENT ---
    function launchApp(appId) {
        if (startMenuOpen) toggleStartMenu();
        const app = APPS.find(a => a.id === appId);
        if (!app) return;

        if (app.type === 'action') {
            if (app.action) app.action();
        } else {
            createWindow(app);
        }
    }

    function createWindow(app) {
        if (activeWindows[app.id]) {
            focusWindow(app.id);
            return;
        }
        const win = document.createElement('div');
        win.id = `${app.id}Window`;
        win.className = 'window';
        win.style.left = `${100 + Math.random() * 200}px`;
        win.style.top = `${50 + Math.random() * 150}px`;
        win.style.zIndex = ++windowZIndex;

        win.innerHTML = `
            <div class="window-titlebar">
                <span>${app.icon} ${app.name}</span>
                <div class="window-controls"><div class="window-control" data-action="close">√ó</div></div>
            </div>
            <div class="window-content">${app.content || ''}</div>`;

        windowContainer.appendChild(win);
        activeWindows[app.id] = win;

        win.querySelector('.window-titlebar').addEventListener('mousedown', onDragStart);
        win.addEventListener('mousedown', () => focusWindow(app.id));
        win.querySelector('.window-control[data-action="close"]').onclick = () => closeWindow(app.id);

        if (app.init) app.init(win);
    }

    function closeWindow(appId) {
        if (activeWindows[appId]) {
            activeWindows[appId].remove();
            delete activeWindows[appId];
        }
    }

    function focusWindow(appId) {
        if (activeWindows[appId]) activeWindows[appId].style.zIndex = ++windowZIndex;
    }
    
    function onDragStart(e) {
        const win = e.target.closest('.window');
        if (!win || e.target.closest('.window-control')) return;
        focusWindow(win.id.replace('Window', ''));
        const offsetX = e.clientX - win.offsetLeft, offsetY = e.clientY - win.offsetTop;
        const onDrag = (moveEvent) => {
            win.style.left = `${moveEvent.clientX - offsetX}px`;
            win.style.top = `${moveEvent.clientY - offsetY}px`;
        };
        document.addEventListener('mousemove', onDrag);
        document.addEventListener('mouseup', () => document.removeEventListener('mousemove', onDrag), { once: true });
    }

    // --- COMMAND PROCESSING ---
    function processTerminalCommand(command) {
        const out = document.getElementById('terminalOutput');
        if (!out) return;
        out.innerHTML += `<div class="input">C:\\Users\\Operator>${command}</div>`;
        const [cmd, ...args] = command.toLowerCase().split(' ');

        switch (cmd) {
            case 'help':
                out.innerHTML += `<div class="info">Available commands: help, cls, dir, ver, exit</div>`;
                break;
            case 'cls':
                out.innerHTML = '';
                break;
            case 'dir':
                out.innerHTML += `<div class="info">Volume in drive C is AEGIS_OS\nDirectory of C:\\Users\\Operator\n\n<DIR> . \n<DIR> .. \n<DIR> Documents\n<DIR> Desktop</div>`;
                break;
            case 'ver':
                out.innerHTML += `<div class="info">Aegis OS [Version 3.1.4]</div>`;
                break;
            case 'exit':
                closeWindow('terminal');
                break;
            default:
                out.innerHTML += `<div class="error">'${cmd}' is not recognized as an internal or external command.</div>`;
        }
        out.scrollTop = out.scrollHeight;
    }

    function handleSecureCommand(command, outputElement) {
        const upperCaseCommand = command.toUpperCase();
        if (passwordVault[upperCaseCommand]) {
            outputElement.innerHTML += `> ${'*'.repeat(command.length)}\n<span class="success">ACCESS GRANTED. OPENING FILE...</span>\n`;
            setTimeout(() => {
                window.open(passwordVault[upperCaseCommand], '_blank');
                outputElement.innerHTML += `\nENTER PASSWORD: `;
            }, 1000);
        } else {
            outputElement.innerHTML += `> ${'*'.repeat(command.length)}\n<span class="error">ACCESS DENIED. INCORRECT PASSWORD.</span>\n\nENTER PASSWORD: `;
        }
    }
    
    // --- EVENT LISTENERS ---
    function toggleStartMenu() {
        startMenuOpen = !startMenuOpen;
        startMenu.classList.toggle('active');
    }
    startButton.addEventListener('click', e => { e.stopPropagation(); toggleStartMenu(); });
    document.addEventListener('click', () => { if (startMenuOpen) toggleStartMenu(); });

    // --- STARTUP ---
    initBoot();
});
</script>
</body>
</html>
